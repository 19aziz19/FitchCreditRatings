df_FitchGovernance %>% filter(y < Junk) %>%
select(CC.PER.RNK, GE.PER.RNK,  RL.PER.RNK, VA.PER.RNK, PV.PER.RNK, RQ.PER.RNK)
df_FitchGovernance %>% filter(y < Junk) %>%
select(CC.PER.RNK, GE.PER.RNK,  RL.PER.RNK, VA.PER.RNK, PV.PER.RNK, RQ.PER.RNK) %>%
summarize(ControlOfCorruption = mean(CC.PER.RNK))
df_FitchGovernance %>% filter(y < Junk) %>%
select(CC.PER.RNK, GE.PER.RNK,  RL.PER.RNK, VA.PER.RNK, PV.PER.RNK, RQ.PER.RNK) %>% summary()
library(radarchart)
df_FitchGovernance %>% filter(y < Junk) %>%
select(CC.PER.RNK, GE.PER.RNK,  RL.PER.RNK, VA.PER.RNK, PV.PER.RNK, RQ.PER.RNK) %>%
na.omit() %>%
summarize(ControlOfCorruption = mean(CC.PER.RNK))
df_FitchGovernance %>% filter(y < Junk) %>%
select(CC.PER.RNK, GE.PER.RNK,  RL.PER.RNK, VA.PER.RNK, PV.PER.RNK, RQ.PER.RNK) %>%
na.omit() %>%
summarize(ControlOfCorruption = mean(CC.PER.RNK),
GovernmentEffectiveness = mean(GE.PER.RNK),
RuleOfLaw = mean(RL.PER.RNK), VoiceAndAccountability = mean(),
PoliticalStabilityAbsenceViolence = mean(PV.PER.RNK),
RegulatoryQuality=mean(RQ.PER.RNK) )
df_FitchGovernance %>% filter(y < Junk) %>%
select(CC.PER.RNK, GE.PER.RNK,  RL.PER.RNK, VA.PER.RNK, PV.PER.RNK, RQ.PER.RNK) %>%
na.omit() %>%
summarize(ControlOfCorruption = mean(CC.PER.RNK),
GovernmentEffectiveness = mean(GE.PER.RNK),
RuleOfLaw = mean(RL.PER.RNK), VoiceAndAccountability = mean(VA.PER.RNK),
PoliticalStabilityAbsenceViolence = mean(PV.PER.RNK),
RegulatoryQuality=mean(RQ.PER.RNK) )
df_FitchGovernance %>% filter(y < Junk) %>%
select(CC.PER.RNK, GE.PER.RNK,  RL.PER.RNK, VA.PER.RNK, PV.PER.RNK, RQ.PER.RNK) %>%
na.omit() %>%
summarize(ControlOfCorruption = mean(CC.PER.RNK),
GovernmentEffectiveness = mean(GE.PER.RNK),
RuleOfLaw = mean(RL.PER.RNK), VoiceAndAccountability = mean(VA.PER.RNK),
PoliticalStabilityAbsenceViolence = mean(PV.PER.RNK),
RegulatoryQuality=mean(RQ.PER.RNK) ) %>%
radarchart()
?radar
install.packages("fsmb")
install.packages("stars")
df_FitchGovernance %>% filter(y < Junk) %>%
select(CC.PER.RNK, GE.PER.RNK,  RL.PER.RNK, VA.PER.RNK, PV.PER.RNK, RQ.PER.RNK) %>%
na.omit() %>%
summarize(ControlOfCorruption = mean(CC.PER.RNK),
GovernmentEffectiveness = mean(GE.PER.RNK),
RuleOfLaw = mean(RL.PER.RNK), VoiceAndAccountability = mean(VA.PER.RNK),
PoliticalStabilityAbsenceViolence = mean(PV.PER.RNK),
RegulatoryQuality=mean(RQ.PER.RNK) ) %>%
chartJSRadar()
labs <- c("ControlOfCorruption", "GovernmentEffectiveness", "RuleOfLaw",  "VoiceAndAccountability","PoliticalStabilityAbsenceViolence","RegulatoryQuality")
df_FitchGovernance %>% filter(y < Junk) %>%
select(CC.PER.RNK, GE.PER.RNK,  RL.PER.RNK, VA.PER.RNK, PV.PER.RNK, RQ.PER.RNK) %>%
na.omit() %>%
summarize(ControlOfCorruption = mean(CC.PER.RNK),
GovernmentEffectiveness = mean(GE.PER.RNK),
RuleOfLaw = mean(RL.PER.RNK), VoiceAndAccountability = mean(VA.PER.RNK),
PoliticalStabilityAbsenceViolence = mean(PV.PER.RNK),
RegulatoryQuality=mean(RQ.PER.RNK) ) %>%
chartJSRadar(labs)
?chartJSRadar
df_FitchGovernance %>% filter(y < Junk) %>%
select(CC.PER.RNK, GE.PER.RNK,  RL.PER.RNK, VA.PER.RNK, PV.PER.RNK, RQ.PER.RNK) %>%
na.omit() %>%
summarize(ControlOfCorruption = mean(CC.PER.RNK),
GovernmentEffectiveness = mean(GE.PER.RNK),
RuleOfLaw = mean(RL.PER.RNK), VoiceAndAccountability = mean(VA.PER.RNK),
PoliticalStabilityAbsenceViolence = mean(PV.PER.RNK),
RegulatoryQuality=mean(RQ.PER.RNK) ) %>%
t() %>%
chartJSRadar()
df_FitchGovernance %>% filter(y < Junk) %>%
select(CC.PER.RNK, GE.PER.RNK,  RL.PER.RNK, VA.PER.RNK, PV.PER.RNK, RQ.PER.RNK) %>%
na.omit() %>%
summarize(ControlOfCorruption = mean(CC.PER.RNK),
GovernmentEffectiveness = mean(GE.PER.RNK),
RuleOfLaw = mean(RL.PER.RNK), VoiceAndAccountability = mean(VA.PER.RNK),
PoliticalStabilityAbsenceViolence = mean(PV.PER.RNK),
RegulatoryQuality=mean(RQ.PER.RNK) ) %>%
t()
df_FitchGovernance %>% filter(y < Junk) %>%
select(CC.PER.RNK, GE.PER.RNK,  RL.PER.RNK, VA.PER.RNK, PV.PER.RNK, RQ.PER.RNK) %>%
na.omit() %>%
summarize(ControlOfCorruption = mean(CC.PER.RNK),
GovernmentEffectiveness = mean(GE.PER.RNK),
RuleOfLaw = mean(RL.PER.RNK), VoiceAndAccountability = mean(VA.PER.RNK),
PoliticalStabilityAbsenceViolence = mean(PV.PER.RNK),
RegulatoryQuality=mean(RQ.PER.RNK) ) %>%
t() %>%
chartJSRadar()
df_FitchGovernance %>% filter(y < Junk) %>%
select(CC.PER.RNK, GE.PER.RNK,  RL.PER.RNK, VA.PER.RNK, PV.PER.RNK, RQ.PER.RNK) %>%
na.omit() %>%
summarize(ControlOfCorruption = mean(CC.PER.RNK),
GovernmentEffectiveness = mean(GE.PER.RNK),
RuleOfLaw = mean(RL.PER.RNK), VoiceAndAccountability = mean(VA.PER.RNK),
PoliticalStabilityAbsenceViolence = mean(PV.PER.RNK),
RegulatoryQuality=mean(RQ.PER.RNK) ) %>%
t() %>%
bind_cols(labs)
labs <- tbl_df(c("ControlOfCorruption", "GovernmentEffectiveness", "RuleOfLaw",  "VoiceAndAccountability","PoliticalStabilityAbsenceViolence","RegulatoryQuality"))
df_FitchGovernance %>% filter(y < Junk) %>%
select(CC.PER.RNK, GE.PER.RNK,  RL.PER.RNK, VA.PER.RNK, PV.PER.RNK, RQ.PER.RNK) %>%
na.omit() %>%
summarize(ControlOfCorruption = mean(CC.PER.RNK),
GovernmentEffectiveness = mean(GE.PER.RNK),
RuleOfLaw = mean(RL.PER.RNK), VoiceAndAccountability = mean(VA.PER.RNK),
PoliticalStabilityAbsenceViolence = mean(PV.PER.RNK),
RegulatoryQuality=mean(RQ.PER.RNK) ) %>%
t() %>%
chartJSRadar(labs)
df_FitchGovernance %>% filter(y < Junk) %>%
select(CC.PER.RNK, GE.PER.RNK,  RL.PER.RNK, VA.PER.RNK, PV.PER.RNK, RQ.PER.RNK) %>%
na.omit() %>%
summarize(ControlOfCorruption = mean(CC.PER.RNK),
GovernmentEffectiveness = mean(GE.PER.RNK),
RuleOfLaw = mean(RL.PER.RNK), VoiceAndAccountability = mean(VA.PER.RNK),
PoliticalStabilityAbsenceViolence = mean(PV.PER.RNK),
RegulatoryQuality=mean(RQ.PER.RNK) ) %>%
t()
labs
df_FitchGovernance %>% filter(y < Junk) %>%
select(CC.PER.RNK, GE.PER.RNK,  RL.PER.RNK, VA.PER.RNK, PV.PER.RNK, RQ.PER.RNK) %>%
na.omit() %>%
summarize(ControlOfCorruption = mean(CC.PER.RNK),
GovernmentEffectiveness = mean(GE.PER.RNK),
RuleOfLaw = mean(RL.PER.RNK), VoiceAndAccountability = mean(VA.PER.RNK),
PoliticalStabilityAbsenceViolence = mean(PV.PER.RNK),
RegulatoryQuality=mean(RQ.PER.RNK) ) %>%
chartJSRadar(labs)
df_FitchGovernance %>% filter(y < Junk) %>%
select(CC.PER.RNK, GE.PER.RNK,  RL.PER.RNK, VA.PER.RNK, PV.PER.RNK, RQ.PER.RNK) %>%
na.omit() %>%
summarize(ControlOfCorruption = mean(CC.PER.RNK),
GovernmentEffectiveness = mean(GE.PER.RNK),
RuleOfLaw = mean(RL.PER.RNK), VoiceAndAccountability = mean(VA.PER.RNK),
PoliticalStabilityAbsenceViolence = mean(PV.PER.RNK),
RegulatoryQuality=mean(RQ.PER.RNK) ) %>%
t() %>%
chartJSRadar(labs)
as.numeric(df_FitchGovernance %>% filter(y < Junk) %>%
select(CC.PER.RNK, GE.PER.RNK,  RL.PER.RNK, VA.PER.RNK, PV.PER.RNK, RQ.PER.RNK) %>%
na.omit() %>%
summarize(ControlOfCorruption = mean(CC.PER.RNK),
GovernmentEffectiveness = mean(GE.PER.RNK),
RuleOfLaw = mean(RL.PER.RNK), VoiceAndAccountability = mean(VA.PER.RNK),
PoliticalStabilityAbsenceViolence = mean(PV.PER.RNK),
RegulatoryQuality=mean(RQ.PER.RNK) )) %>%
t() %>%
chartJSRadar(labs)
as.numeric(df_FitchGovernance %>% filter(y < Junk) %>%
select(CC.PER.RNK, GE.PER.RNK,  RL.PER.RNK, VA.PER.RNK, PV.PER.RNK, RQ.PER.RNK) %>%
na.omit() %>%
summarize(ControlOfCorruption = mean(CC.PER.RNK),
GovernmentEffectiveness = mean(GE.PER.RNK),
RuleOfLaw = mean(RL.PER.RNK), VoiceAndAccountability = mean(VA.PER.RNK),
PoliticalStabilityAbsenceViolence = mean(PV.PER.RNK),
RegulatoryQuality=mean(RQ.PER.RNK) )) %>%
chartJSRadar(labs)
labs <- c("ControlOfCorruption", "GovernmentEffectiveness", "RuleOfLaw",  "VoiceAndAccountability","PoliticalStabilityAbsenceViolence","RegulatoryQuality")
as.numeric(df_FitchGovernance %>% filter(y < Junk) %>%
select(CC.PER.RNK, GE.PER.RNK,  RL.PER.RNK, VA.PER.RNK, PV.PER.RNK, RQ.PER.RNK) %>%
na.omit() %>%
summarize(ControlOfCorruption = mean(CC.PER.RNK),
GovernmentEffectiveness = mean(GE.PER.RNK),
RuleOfLaw = mean(RL.PER.RNK), VoiceAndAccountability = mean(VA.PER.RNK),
PoliticalStabilityAbsenceViolence = mean(PV.PER.RNK),
RegulatoryQuality=mean(RQ.PER.RNK) )) %>%
chartJSRadar(labs)
as.numeric(df_FitchGovernance %>% filter(y < Junk) %>%
select(CC.PER.RNK, GE.PER.RNK,  RL.PER.RNK, VA.PER.RNK, PV.PER.RNK, RQ.PER.RNK) %>%
na.omit() %>%
summarize(ControlOfCorruption = mean(CC.PER.RNK),
GovernmentEffectiveness = mean(GE.PER.RNK),
RuleOfLaw = mean(RL.PER.RNK), VoiceAndAccountability = mean(VA.PER.RNK),
PoliticalStabilityAbsenceViolence = mean(PV.PER.RNK),
RegulatoryQuality=mean(RQ.PER.RNK) ))
scores <- list(Investment = as.numeric(df_FitchGovernance %>% filter(y < Junk) %>%
select(CC.PER.RNK, GE.PER.RNK,  RL.PER.RNK, VA.PER.RNK, PV.PER.RNK, RQ.PER.RNK) %>%
na.omit() %>%
summarize(ControlOfCorruption = mean(CC.PER.RNK),
GovernmentEffectiveness = mean(GE.PER.RNK),
RuleOfLaw = mean(RL.PER.RNK), VoiceAndAccountability = mean(VA.PER.RNK),
PoliticalStabilityAbsenceViolence = mean(PV.PER.RNK),
RegulatoryQuality=mean(RQ.PER.RNK) ))
chartJSRadar(scores, labs)
scores <- list(Investment = as.numeric(df_FitchGovernance %>% filter(y < Junk) %>%
select(CC.PER.RNK, GE.PER.RNK,  RL.PER.RNK, VA.PER.RNK, PV.PER.RNK, RQ.PER.RNK) %>%
na.omit() %>%
summarize(ControlOfCorruption = mean(CC.PER.RNK),
GovernmentEffectiveness = mean(GE.PER.RNK),
RuleOfLaw = mean(RL.PER.RNK), VoiceAndAccountability = mean(VA.PER.RNK),
PoliticalStabilityAbsenceViolence = mean(PV.PER.RNK),
RegulatoryQuality=mean(RQ.PER.RNK) )
chartJSRadar(scores, labs)
scores <- as.numeric(df_FitchGovernance %>% filter(y < Junk) %>%
select(CC.PER.RNK, GE.PER.RNK,  RL.PER.RNK, VA.PER.RNK, PV.PER.RNK, RQ.PER.RNK) %>%
na.omit() %>%
summarize(ControlOfCorruption = mean(CC.PER.RNK),
GovernmentEffectiveness = mean(GE.PER.RNK),
RuleOfLaw = mean(RL.PER.RNK), VoiceAndAccountability = mean(VA.PER.RNK),
PoliticalStabilityAbsenceViolence = mean(PV.PER.RNK),
RegulatoryQuality=mean(RQ.PER.RNK) )
)
chartJSRadar(scores, labs)
scores = list(Rich = scores)
chartJSRadar(scores, labs)
Investment <- as.numeric(df_FitchGovernance %>% filter(y < Junk) %>%
select(CC.PER.RNK, GE.PER.RNK,  RL.PER.RNK, VA.PER.RNK, PV.PER.RNK, RQ.PER.RNK) %>%
na.omit() %>%
summarize(ControlOfCorruption = mean(CC.PER.RNK),
GovernmentEffectiveness = mean(GE.PER.RNK),
RuleOfLaw = mean(RL.PER.RNK), VoiceAndAccountability = mean(VA.PER.RNK),
PoliticalStabilityAbsenceViolence = mean(PV.PER.RNK),
RegulatoryQuality=mean(RQ.PER.RNK) ) )
Junk <- as.numeric(df_FitchGovernance %>% filter(y < Junk) %>%
select(CC.PER.RNK, GE.PER.RNK,  RL.PER.RNK, VA.PER.RNK, PV.PER.RNK, RQ.PER.RNK) %>%
na.omit() %>%
summarize(ControlOfCorruption = mean(CC.PER.RNK),
GovernmentEffectiveness = mean(GE.PER.RNK),
RuleOfLaw = mean(RL.PER.RNK), VoiceAndAccountability = mean(VA.PER.RNK),
PoliticalStabilityAbsenceViolence = mean(PV.PER.RNK),
RegulatoryQuality=mean(RQ.PER.RNK) ) )
scores = list(Junk = Junk, Investment = Investment)
chartJSRadar(scores, labs)
? chartJSRadar
scores = list("Junk" = Junk, "Investment" = Investment)
chartJSRadar(scores, labs)
scores = list( "Investment" = Investment, "Junk" = Junk)
chartJSRadar(scores, labs)
Investment <- as.numeric(df_FitchGovernance %>% filter(y < Junk) %>%
select(CC.PER.RNK, GE.PER.RNK,  RL.PER.RNK, VA.PER.RNK, PV.PER.RNK, RQ.PER.RNK) %>%
na.omit() %>%
summarize(ControlOfCorruption = mean(CC.PER.RNK),
GovernmentEffectiveness = mean(GE.PER.RNK),
RuleOfLaw = mean(RL.PER.RNK), VoiceAndAccountability = mean(VA.PER.RNK),
PoliticalStabilityAbsenceViolence = mean(PV.PER.RNK),
RegulatoryQuality=mean(RQ.PER.RNK) ) )
Junk <- as.numeric(df_FitchGovernance %>% filter(y >= Junk) %>%
select(CC.PER.RNK, GE.PER.RNK,  RL.PER.RNK, VA.PER.RNK, PV.PER.RNK, RQ.PER.RNK) %>%
na.omit() %>%
summarize(ControlOfCorruption = mean(CC.PER.RNK),
GovernmentEffectiveness = mean(GE.PER.RNK),
RuleOfLaw = mean(RL.PER.RNK), VoiceAndAccountability = mean(VA.PER.RNK),
PoliticalStabilityAbsenceViolence = mean(PV.PER.RNK),
RegulatoryQuality=mean(RQ.PER.RNK) ) )
scores = list( "Investment" = Investment, "Junk" = Junk)
chartJSRadar(scores, labs)
Junk <- as.numeric(df_FitchGovernance %>% filter(y >= Junk) %>%
select(CC.PER.RNK, GE.PER.RNK,  RL.PER.RNK, VA.PER.RNK, PV.PER.RNK, RQ.PER.RNK) %>%
na.omit() %>%
summarize(ControlOfCorruption = mean(CC.PER.RNK),
GovernmentEffectiveness = mean(GE.PER.RNK),
RuleOfLaw = mean(RL.PER.RNK), VoiceAndAccountability = mean(VA.PER.RNK),
PoliticalStabilityAbsenceViolence = mean(PV.PER.RNK),
RegulatoryQuality=mean(RQ.PER.RNK) ) )
as.numeric(df_FitchGovernance %>% filter(y >= Junk) %>%
select(CC.PER.RNK, GE.PER.RNK,  RL.PER.RNK, VA.PER.RNK, PV.PER.RNK, RQ.PER.RNK)
)
df_FitchGovernance %>% filter(y >= Junk) %>%
select(CC.PER.RNK, GE.PER.RNK,  RL.PER.RNK, VA.PER.RNK, PV.PER.RNK, RQ.PER.RNK) %>%
na.omit()
Junk = 9.5
library(radarchart)
labs <- c("ControlOfCorruption", "GovernmentEffectiveness", "RuleOfLaw",  "VoiceAndAccountability","PoliticalStabilityAbsenceViolence","RegulatoryQuality")
Investment <- as.numeric(df_FitchGovernance %>% filter(y < Junk) %>%
select(CC.PER.RNK, GE.PER.RNK,  RL.PER.RNK, VA.PER.RNK, PV.PER.RNK, RQ.PER.RNK) %>%
na.omit() %>%
summarize(ControlOfCorruption = mean(CC.PER.RNK),
GovernmentEffectiveness = mean(GE.PER.RNK),
RuleOfLaw = mean(RL.PER.RNK), VoiceAndAccountability = mean(VA.PER.RNK),
PoliticalStabilityAbsenceViolence = mean(PV.PER.RNK),
RegulatoryQuality=mean(RQ.PER.RNK) ) )
Junk <- as.numeric(df_FitchGovernance %>% filter(y > Junk) %>%
select(CC.PER.RNK, GE.PER.RNK,  RL.PER.RNK, VA.PER.RNK, PV.PER.RNK, RQ.PER.RNK) %>%
na.omit() %>%
summarize(ControlOfCorruption = mean(CC.PER.RNK),
GovernmentEffectiveness = mean(GE.PER.RNK),
RuleOfLaw = mean(RL.PER.RNK), VoiceAndAccountability = mean(VA.PER.RNK),
PoliticalStabilityAbsenceViolence = mean(PV.PER.RNK),
RegulatoryQuality=mean(RQ.PER.RNK) ) )
scores = list( "Investment" = Investment, "Junk" = Junk)
chartJSRadar(scores, labs)
scores = list( "Junk" = Junk, "Investment" = Investment)
chartJSRadar(scores, labs)
Prime <- as.numeric(df_FitchGovernance %>% filter(y == 1) %>%
select(CC.PER.RNK, GE.PER.RNK,  RL.PER.RNK, VA.PER.RNK, PV.PER.RNK, RQ.PER.RNK) %>%
na.omit() %>%
summarize(ControlOfCorruption = mean(CC.PER.RNK),
GovernmentEffectiveness = mean(GE.PER.RNK),
RuleOfLaw = mean(RL.PER.RNK), VoiceAndAccountability = mean(VA.PER.RNK),
PoliticalStabilityAbsenceViolence = mean(PV.PER.RNK),
RegulatoryQuality=mean(RQ.PER.RNK) ) )
scores = list( "Junk" = Junk, "Investment" = Investment, "Prime" = Prime)
chartJSRadar(scores, labs)
?chartJSRadar
for (i in 1:7) {
#yhat_knn_test <- as.integer(knn3Train(df_model_train[,2:18], df_model_test[2:18],      as.factor(df_model_train[,1]), k = i, l = 0, prob = FALSE, use.all = TRUE))
yhat_knn_train <- knn3(y~., df_model_train[,2:18], k=1)
yhat_knn_train <- round(predict(fit, newdata = df_model_train[,2:18]))[,2]
cat("k = ", i, ": ",RMSE(df_model_test[,1],yhat_knn_train), "\n")
}
for (i in 1:7) {
#yhat_knn_test <- as.integer(knn3Train(df_model_train[,2:18], df_model_test[2:18],      as.factor(df_model_train[,1]), k = i, l = 0, prob = FALSE, use.all = TRUE))
model_knn <- knn3(y~., df_model_train[,2:18], k=1)
yhat_knn_train <- round(predict(model_knn, newdata = df_model_train[,2:18]))[,2]
cat("k = ", i, ": ",RMSE(df_model_test[,1],yhat_knn_train), "\n")
}
model_knn <- knn3(y~., df_model_train[,2:18], k=1)
View(xgtrain)
df_model_train
model_knn <- knn3(locallongterm~., df_model_train, k=1)
model_knn <- knn3(locallongterm~., df_model_train, k=i)
yhat_knn_train <- round(predict(model_knn, newdata = df_model_train[,2:20]))[,2]
cat("k = ", i, ": ",RMSE(df_model_test[,1],yhat_knn_train), "\n")
model_knn <- knn3(locallongterm~., df_model_train, k=i)
yhat_knn_train <- round(predict(model_knn, newdata = df_model_train[,2:20]))[,2]
cat("k = ", i, ": ",RMSE(df_model_train[,1],yhat_knn_train), "\n")
for (i in 1:7) {
#yhat_knn_test <- as.integer(knn3Train(df_model_train[,2:18], df_model_test[2:18],      as.factor(df_model_train[,1]), k = i, l = 0, prob = FALSE, use.all = TRUE))
model_knn <- knn3(locallongterm~., df_model_train, k=i)
yhat_knn_train <- round(predict(model_knn, newdata = df_model_train[,2:20]))[,2]
cat("k = ", i, ": ",RMSE(df_model_train[,1],yhat_knn_train), "\n")
}
predict(model_knn, newdata = df_model_train)
model_knn <- knn3(locallongterm~., df_model_train, k=i, prob=FALSE)
yhat_knn_train <- round(predict(model_knn, newdata = df_model_train, prob = F))[,2]
cat("k = ", i, ": ",RMSE(df_model_train[,1],yhat_knn_train), "\n")
yhat_knn_train
round(predict(model_knn, newdata = df_model_train, prob = F))
seq(1,21)
yhat_knn_train %*% seq(1,21)
yhat_knn_train <- round(predict(model_knn, newdata = df_model_train, prob = F))
yhat_knn_train %*% seq(1,21)
for (i in 1:7) {
yhat_knn_test <- as.integer(knn3Train(df_model_train[,2:18], df_model_test[2:18],      as.factor(df_model_train[,1]), k = i, l = 0, prob = FALSE, use.all = TRUE))
cat("k = ", i, ": ",RMSE(df_model_test[,1],yhat_knn_test), "\n")
}
yhat_knn_test <- as.integer(knn3Train(df_model_train[,2:20], df_model_test[2:20],      as.factor(df_model_train[,1]), k = 1, l = 0, prob = FALSE, use.all = TRUE))
yhat_knn_test <- as.integer(knn3Train(df_model_train[,2:20], df_model_test[2:20],      as.factor(df_model_train[,1]), k = 1, l = 0, prob = FALSE, use.all = TRUE))
xgtrain <- data.matrix(df_model_train[,-1])
for (i in 1:7) {
yhat_knn_test <- as.integer(knn3Train(df_model_train[,2:18], df_model_test[2:18],      as.factor(df_model_train[,1]), k = i, l = 0, prob = FALSE, use.all = TRUE))
cat("k = ", i, ": ",RMSE(df_model_test[,1],yhat_knn_test), "\n")
}
yhat_knn_test <- as.integer(knn3Train(df_model_train[,2:20], df_model_test[2:20],      as.factor(df_model_train[,1]), k = 1, l = 0, prob = FALSE, use.all = TRUE))
for (i in 1:7) {
yhat_knn_test <- as.integer(knn3Train(df_model_train[,2:18], df_model_test[2:18],      as.factor(df_model_train[,1]), k = i, l = 0, prob = FALSE, use.all = TRUE))
cat("k = ", i, ": ",RMSE(df_model_test[,1],yhat_knn_test), "\n")
}
for (i in 1:7) {
yhat_knn_test <- as.integer(knn3Train(df_model_train[,2:18], df_model_test[2:18],      as.factor(df_model_train[,1]), k = i, l = 0, prob = FALSE, use.all = TRUE))
cat("k = ", i, ": ",RMSE(df_model_test[,1],yhat_knn_test), "\n")
}
for (i in 1:7) {
yhat_knn_test <- as.integer(knn3Train(df_model_train[,2:18], df_model_test[2:18],      as.factor(df_model_train[,1]), k = i, l = 0, prob = FALSE, use.all = TRUE))
cat("k = ", i, ": ",RMSE(df_model_test[,1],yhat_knn_test), "\n")
}
for (i in 1:7) {
yhat_knn_test <- as.integer(knn3Train(df_model_train[,2:18], df_model_test[2:18],      as.factor(df_model_train[,1]), k = i, l = 0, prob = FALSE, use.all = TRUE))
cat("k = ", i, ": ",RMSE(df_model_test[,1],yhat_knn_test), "\n")
}
for (i in 1:7) {
yhat_knn_test <- as.integer(knn3Train(df_model_train[,2:18], df_model_test[2:18],      as.factor(df_model_train[,1]), k = i, l = 0, prob = FALSE, use.all = TRUE))
cat("k = ", i, ": ",RMSE(df_model_test[,1],yhat_knn_test), "\n")
}
for (i in 1:7) {
yhat_knn_test <- as.integer(knn3Train(df_model_train, df_model_test,      as.factor(df_model_train[,1]), k = i, l = 0, prob = FALSE, use.all = TRUE))
cat("k = ", i, ": ",RMSE(df_model_test[,1],yhat_knn_test), "\n")
}
for (i in 1:7) {
yhat_knn_test <- as.integer(knn3Train(df_model_train, df_model_test,      as.factor(df_model_train[,1]), k = i, l = 0, prob = FALSE, use.all = TRUE))
cat("k = ", i, ": ",RMSE(df_model_test[,1],yhat_knn_test), "\n")
}
for (i in 1:7) {
yhat_knn_test <- as.integer(knn3Train(df_model_train, df_model_test,      as.factor(df_model_train[,1]), k = i, l = 0, prob = FALSE, use.all = TRUE))
cat("k = ", i, ": ",RMSE(df_model_test[,1],yhat_knn_test), "\n")
}
for (i in 1:7) {
yhat_knn_test <- as.integer(knn3Train(df_model_train, df_model_test,      as.factor(df_model_train[,1]), k = i, l = 0, prob = FALSE, use.all = TRUE))
cat("k = ", i, ": ",RMSE(df_model_test[,1],yhat_knn_test), "\n")
}
for (i in 1:7) {
yhat_knn_test <- as.integer(knn3Train(df_model_train, df_model_test,      as.factor(df_model_train[,1]), k = i, l = 0, prob = FALSE, use.all = TRUE))
cat("k = ", i, ": ",RMSE(df_model_test[,1],yhat_knn_test), "\n")
}
yhat_knn_test
yhat_knn_test <- as.integer(knn3Train(df_model_train[,2:20], df_model_test[2:20],      as.factor(df_model_train[,1]), k = 1, l = 0, prob = FALSE, use.all = TRUE))
y_e <- round((yhat_xgb_test + yhat_lm_test + yhat_knn_test)/3)
RMSE(y_e,df_model_test[,1])
y_e <- round((yhat_xgb_test*2 + yhat_lm_test + yhat_knn_test)/4)
RMSE(y_e,df_model_test[,1])
y_e <- round((yhat_xgb_test*3 + yhat_lm_test + yhat_knn_test)/5)
RMSE(y_e,df_model_test[,1])
y_e <- round((yhat_xgb_test*4 + yhat_lm_test + yhat_knn_test)/6)
RMSE(y_e,df_model_test[,1])
for (i in 1:7) {
yhat_knn_test <- as.integer(knn3Train(df_model_train[,2:18], df_model_test[2:18],      as.factor(df_model_train[,1]), k = i, l = 0, prob = FALSE, use.all = TRUE))
cat("k = ", i, ": ",RMSE(df_model_test[,1],yhat_knn_test), "\n")
}
yhat_knn_test <- as.integer(knn3Train(df_model_train[,2:18], df_model_test[2:18],      as.factor(df_model_train[,1]), k = 1, l = 0, prob = FALSE, use.all = TRUE))
xgtrain <- data.matrix(df_model_train[,-1])
xgval <- data.matrix(df_model_test[,-1])
y_e <- round((yhat_xgb_test + yhat_lm_test + yhat_knn_test)/3)
RMSE(y_e,df_model_test[,1])
y_e <- round((yhat_xgb_test*2 + yhat_lm_test + yhat_knn_test)/4)
RMSE(y_e,df_model_test[,1])
y_e <- round((yhat_xgb_test*3 + yhat_lm_test + yhat_knn_test)/5)
RMSE(y_e,df_model_test[,1])
y_e <- round((yhat_xgb_test*4 + yhat_lm_test + yhat_knn_test)/6)
RMSE(y_e,df_model_test[,1])
y_e <- round((yhat_xgb_test*3 + yhat_lm_test*2 + yhat_knn_test*1)/6)
RMSE(y_e,df_model_test[,1])
set.seed(9062)
yhat_knn_test <- as.integer(knn3Train(df_model_train[,2:18], df_model_test[2:18],      as.factor(df_model_train[,1]), k = 1, l = 0, prob = FALSE, use.all = TRUE))
set.seed(9062)
yhat_knn_test <- as.integer(knn3Train(df_model_train[,2:18], df_model_test[2:18],      as.factor(df_model_train[,1]), k = 1, l = 0, prob = FALSE, use.all = TRUE))
set.seed(9062)
yhat_knn_test <- as.integer(knn3Train(df_model_train[,2:18], df_model_test[2:18],      as.factor(df_model_train[,1]), k = 1, l = 0, prob = FALSE, use.all = TRUE))
cat("k = ", i, ": ",RMSE(df_model_test[,1],yhat_knn_test), "\n")
set.seed(9892)
yhat_knn_test <- as.integer(knn3Train(df_model_train[,2:18], df_model_test[2:18],      as.factor(df_model_train[,1]), k = 1, l = 0, prob = FALSE, use.all = TRUE))
cat("k = ", i, ": ",RMSE(df_model_test[,1],yhat_knn_test), "\n")
set.seed(9892)
yhat_knn_test <- as.integer(knn3Train(df_model_train[,2:18], df_model_test[2:18],      as.factor(df_model_train[,1]), k = 1, l = 0, prob = FALSE, use.all = TRUE))
cat("k = ", i, ": ",RMSE(df_model_test[,1],yhat_knn_test), "\n")
y_e <- round((yhat_xgb_test + yhat_lm_test + yhat_knn_test)/3)
RMSE(y_e,df_model_test[,1])
y_e <- round((yhat_xgb_test*2 + yhat_lm_test + yhat_knn_test)/4)
RMSE(y_e,df_model_test[,1])
y_e <- round((yhat_xgb_test*3 + yhat_lm_test + yhat_knn_test)/5)
RMSE(y_e,df_model_test[,1])
y_e <- round((yhat_xgb_test*4 + yhat_lm_test + yhat_knn_test)/6)
RMSE(y_e,df_model_test[,1])
y_e <- round((yhat_xgb_test*3 + yhat_lm_test*2 + yhat_knn_test*1)/6)
RMSE(y_e,df_model_test[,1])
for (i in 1:7) {
set.seed(9892)
yhat_knn_test <- as.integer(knn3Train(df_model_train[,2:18], df_model_test[2:18],      as.factor(df_model_train[,1]), k = i, l = 0, prob = FALSE, use.all = TRUE))
cat("k = ", i, ": ",RMSE(df_model_test[,1],yhat_knn_test), "\n")
}
set.seed(9892)
yhat_knn_test <- as.integer(knn3Train(df_model_train[,2:18], df_model_test[2:18],      as.factor(df_model_train[,1]), k = 1, l = 0, prob = FALSE, use.all = TRUE))
cat("k = ", i, ": ",RMSE(df_model_test[,1],yhat_knn_test), "\n")
RMSE(y_e,df_model_test[,1])
df_Ensemble <- cat("yhat_xgb_test + yhat_lm_test + yhat_knn_test)/3", RMSE(y_e,df_model_test[,1])
y_e <- round((yhat_xgb_test*2 + yhat_lm_test + yhat_knn_test)/4)
df_Ensemble <- rbind(df_Ensemble, cat("yhat_xgb_test*2 + yhat_lm_test + yhat_knn_test)/4" , RMSE(y_e,df_model_test[,1]))
y_e <- round((yhat_xgb_test*3 + yhat_lm_test + yhat_knn_test)/5)
df_Ensemble <- c("yhat_xgb_test + yhat_lm_test + yhat_knn_test)/3", RMSE(y_e,df_model_test[,1])
)
y_e <- round((yhat_xgb_test + yhat_lm_test + yhat_knn_test)/3)
df_Ensemble <- c("yhat_xgb_test + yhat_lm_test + yhat_knn_test)/3", RMSE(y_e,df_model_test[,1]))
y_e <- round((yhat_xgb_test*2 + yhat_lm_test + yhat_knn_test)/4)
df_Ensemble <- rbind(df_Ensemble, c("yhat_xgb_test*2 + yhat_lm_test + yhat_knn_test)/4" , RMSE(y_e,df_model_test[,1]))
)
df_Ensemble
y_e <- round((yhat_xgb_test + yhat_lm_test + yhat_knn_test)/3)
df_Ensemble  <- c(1,1,1,RMSE(y_e,df_model_test[,1]))
y_e <- round((yhat_xgb_test*2 + yhat_lm_test + yhat_knn_test)/4)
df_Ensemble <- rbind(df_Ensemble, c(2,1,1, RMSE(y_e,df_model_test[,1])))
df_Ensemble
y_e <- round((yhat_xgb_test + yhat_lm_test + yhat_knn_test)/3)
df_Ensemble  <- c(1,1,1,RMSE(y_e,df_model_test[,1]))
y_e <- round((yhat_xgb_test*2 + yhat_lm_test + yhat_knn_test)/4)
df_Ensemble <- rbind(df_Ensemble, c(2,1,1, RMSE(y_e,df_model_test[,1])))
y_e <- round((yhat_xgb_test*3 + yhat_lm_test + yhat_knn_test)/5)
df_Ensemble <- rbind(df_Ensemble, c(3,1,1, RMSE(y_e,df_model_test[,1])))
y_e <- round((yhat_xgb_test*4 + yhat_lm_test + yhat_knn_test)/6)
df_Ensemble <- rbind(df_Ensemble, c(4,1,1, RMSE(y_e,df_model_test[,1])))
y_e <- round((yhat_xgb_test*3 + yhat_lm_test*2 + yhat_knn_test*1)/6)
df_Ensemble <- rbind(df_Ensemble, c(3,2,1, RMSE(y_e,df_model_test[,1])))
df_Ensemble
df_Ensemble <- rbind(df_Ensemble, round(c(2,1,1, RMSE(y_e,df_model_test[,1]),2)))
df_Ensemble <- rbind(df_Ensemble, c(2,1,1, round(RMSE(y_e,df_model_test[,1]),2)))
df_Ensemble
?round
df_Ensemble <- rbind(df_Ensemble, c(2,1,1, signif(RMSE(y_e,df_model_test[,1]),2)))
df_Ensemble
df_Ensemble  <- c(1,1,1,signif(RMSE(y_e,df_model_test[,1]),2))
y_e <- round((yhat_xgb_test*2 + yhat_lm_test + yhat_knn_test)/4)
df_Ensemble <- rbind(df_Ensemble, c(2,1,1, signif(RMSE(y_e,df_model_test[,1]),3)))
y_e <- round((yhat_xgb_test*3 + yhat_lm_test + yhat_knn_test)/5)
df_Ensemble <- rbind(df_Ensemble, c(2,1,1, signif(RMSE(y_e,df_model_test[,1]),3)))
y_e <- round((yhat_xgb_test*4 + yhat_lm_test + yhat_knn_test)/6)
df_Ensemble <- rbind(df_Ensemble, c(2,1,1, signif(RMSE(y_e,df_model_test[,1]),3)))
y_e <- round((yhat_xgb_test*3 + yhat_lm_test*2 + yhat_knn_test*1)/6)
df_Ensemble <- rbind(df_Ensemble, c(2,1,1, signif(RMSE(y_e,df_model_test[,1]),3)))
df_Ensemble
colnames(df_Ensemble) <- c("Prop XGB", "Prop Linear Reg", "Prop kNN", "RMSE")
df_Ensemble
colnames(df_Ensemble) <- c("Prop XGB", "Prop Reg", "Prop kNN", "RMSE")
#Ensemble
y_e <- round((yhat_xgb_test + yhat_lm_test + yhat_knn_test)/3)
df_Ensemble  <- c(1,1,1,signif(RMSE(y_e,df_model_test[,1]),2))
y_e <- round((yhat_xgb_test*2 + yhat_lm_test + yhat_knn_test)/4)
df_Ensemble <- rbind(df_Ensemble, c(2,1,1, signif(RMSE(y_e,df_model_test[,1]),3)))
y_e <- round((yhat_xgb_test*3 + yhat_lm_test + yhat_knn_test)/5)
df_Ensemble <- rbind(df_Ensemble, c(3,1,1, signif(RMSE(y_e,df_model_test[,1]),3)))
y_e <- round((yhat_xgb_test*4 + yhat_lm_test + yhat_knn_test)/6)
df_Ensemble <- rbind(df_Ensemble, c(4,1,1, signif(RMSE(y_e,df_model_test[,1]),3)))
y_e <- round((yhat_xgb_test*3 + yhat_lm_test*2 + yhat_knn_test*1)/6)
df_Ensemble <- rbind(df_Ensemble, c(3,2,1, signif(RMSE(y_e,df_model_test[,1]),3)))
colnames(df_Ensemble) <- c("Prop XGB", "Prop Reg", "Prop kNN", "RMSE")
df_Ensemble
colnames(df_Ensemble) <- c("Prop XGB", "Prop Reg", "Prop kNN", "  RMSE  ")
df_Ensemble
RMSE(yhat_xgb_test ,df_model_test[,1])
RMSE(df_model_test[,1],yhat_lm_test)
scale_x_discrete(limits=CreditRatings) +
summary(model.lm)
model.lm <- lm(locallongterm ~ ., data = df_model_train)
summary(model.lm)
